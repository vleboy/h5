var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i},__awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function s(e){try{u(n.next(e))}catch(t){r(t)}}function a(e){try{u(n["throw"](e))}catch(t){r(t)}}function u(e){e.done?o(e.value):new i(function(t){t(e.value)}).then(s,a)}u((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,r&&(s=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){u.label=i[1];break}if(6===i[0]&&u.label<s[1]){u.label=s[1],s=i;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(i);break}s[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(n){i=[6,n],r=0}finally{o=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var o,r,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},game;!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.eventDic=new e.Dictionary,i.once(egret.Event.COMPLETE,function(){i.init(),i.onStageResize()},i),i}return __extends(i,t),i.prototype.onStageResize=function(){},i.prototype.registerEvent=function(e,t,i,n){var o={};o.target=e,o.type=t,o.callBack=i,o.thisObject=n,e&&(e.addEventListener(t,i,n),this.eventDic.setValue(e.hashCode+t,o))},i.prototype.removeAllEvent=function(){for(var e=this.eventDic.getAllValue();e.length>0;){var t=e.shift();null!=t.target&&t.target.removeEventListener(t.type,t.callBack,t.thisObject)}this.eventDic.clear()},i.prototype.sendNotify=function(t,i){e.NotifyManager.getInstance().sendNotify(t,i)},i.prototype.dispose=function(){this.removeAllEvent(),this.parent&&this.parent.removeChild(this)},i}(eui.Component);e.BaseUI=t,__reflect(t.prototype,"game.BaseUI")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.BaseVO=t,__reflect(t.prototype,"game.BaseVO")}(game||(game={}));var game;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(e.BaseVO);e.LoginVO=t,__reflect(t.prototype,"game.LoginVO")}(game||(game={}));var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,i,n){function o(e){t.call(n,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}var s=this;"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(n,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(e,i){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(n,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_TEXT))},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.imgs=[],t.currentFrame=0,t.loop=-1,t.speed=5,t._flag=0,t}return __extends(t,e),t.prototype.play=function(){this.currentFrame=0,this.source=this.imgs[this.currentFrame],this.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},t.prototype.stop=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},t.prototype.onFrame=function(){this._flag++,this._flag>=this.speed&&(this.nextFrame(),this._flag=0)},t.prototype.nextFrame=function(){if(this.currentFrame++,this.currentFrame==this.imgs.length){if(this.loop--,0==this.loop)return this.dispatchEventWith(t.COMPLETE),void this.stop();this.currentFrame=0}this.source=this.imgs[this.currentFrame]},Object.defineProperty(t.prototype,"sources",{set:function(e){var t=e.split("|"),i=t[1],n=parseInt(i.split("-")[0]),o=parseInt(i.split("-")[1]);this.imgs=[];for(var r=n;o>=r;r++)this.imgs.push(t[0]+r+t[2])},enumerable:!0,configurable:!0}),t.COMPLETE="loopComplete",t}(eui.Image);e.AMovieClip=t,__reflect(t.prototype,"game.AMovieClip")}(game||(game={}));var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function n(n){t.call(i,n,e)}if(RES.hasRes(e)){var o=RES.getRes(e);o?n(o):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.ADDED_TO_STAGE,function(){t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,t.buttonReleased,t)},t),t}return __extends(t,e),t.prototype.onTouchBegin=function(t){e.prototype.onTouchBegin.call(this,t),this.scaleX=this.scaleY=.9},t.prototype.buttonReleased=function(){e.prototype.buttonReleased.call(this),this.scaleX=this.scaleY=1},t.prototype.onTouchCancle=function(t){e.prototype.onTouchCancle.call(this,t),this.scaleX=this.scaleY=1},t}(eui.Button);e.SmallButton=t,__reflect(t.prototype,"game.SmallButton")}(game||(game={}));var game;!function(e){var t=function(){function e(){this.pool={}}return e.getInstance=function(){return this._instance?this._instance:this._instance=new e},e.prototype.addRegister=function(e,t){var i=this;t&&t.length>0&&t.forEach(function(t){i.pool[t]||(i.pool[t]=[]),i.pool[t].indexOf(e)<0&&i.pool[t].push(e)})},e.prototype.sendNotify=function(e,t){var i=this.pool[e];i&&i.forEach(function(i){i.handleNotify(e,t)})},e.prototype.removeRegister=function(e){var t=this;this.pool.keys.forEach(function(i){var n=t.pool[i].indexOf(e);n>-1&&t.pool[i].splice(n,1),0==t.pool[i].length&&delete t.pool[i]})},e}();e.NotifyManager=t,__reflect(t.prototype,"game.NotifyManager")}(game||(game={}));var game;!function(e){var t=function(){function t(){}return t.closeMusic=function(t){void 0===t&&(t=!0),e.GlobalConfig.musicSwitch=!t,t&&this.musicChannel&&(this.musicChannel.stop(),this.musicChannel=null)},t.closeEffect=function(t){void 0===t&&(t=!0),e.GlobalConfig.effectSwitch=!t,t&&(this.effectArr.forEach(function(e){return e.stop()}),this.effectArr=[])},t.playEffect=function(t,i){var n=this;if(void 0===i&&(i=1),console.log("playeffect "+t),e.GlobalConfig.effectSwitch){var o=RES.getRes(t).play(0,i);return this.effectArr.push(o),o.addEventListener(egret.Event.SOUND_COMPLETE,function(){var e=[];n.effectArr.forEach(function(t){!t.isStopped&&e.push(t)}),n.effectArr=e},this),o}},t.playMusic=function(t){e.GlobalConfig.musicSwitch&&(this.musicChannel&&this.musicChannel.stop(),this.musicChannel=RES.getRes(t).play(0))},t.effectArr=[],t}();e.SoundPlayer=t,__reflect(t.prototype,"game.SoundPlayer")}(game||(game={}));var game;!function(e){var t=function(){function e(){this.dict={}}return e.prototype.setValue=function(e,t){this.dict[e]=t},e.prototype.getValue=function(e){return this.dict[e]},e.prototype.getAllKey=function(){var e=[];for(var t in this.dict)e.push(t);return e},e.prototype.getAllValue=function(){var e=[];for(var t in this.dict)e.push(this.dict[t]);return e},e.prototype.containsKey=function(e){return null==this.dict[e]?!1:!0},e.prototype.removeKey=function(e){this.dict[e]=null,delete this.dict[e]},e.prototype.removeValue=function(e){for(var t in this.dict)if(this.dict[t]==e){this.removeKey(t);break}},e.prototype.getKeyByValue=function(e){for(var t in this.dict)if(this.dict[t]==e)return t;return null},e.prototype.getKeyLength=function(){var e=0;for(var t in this.dict)e++;return e},e.prototype.clear=function(){this.dict=null,this.dict={}},e.prototype.toString=function(){return this.dict.toString()},e}();e.Dictionary=t,__reflect(t.prototype,"game.Dictionary")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e.setWaterRippleFilter=function(e,t,i){var n=this,o=new egret.CustomFilter(this.vertexSrc,this.fragmentSrc_waterRipple,{center:{x:.5,y:.5},params:{x:10,y:.8,z:.1},time:0});e.filters=[o];var r=function(){o.uniforms.time+=.03,o.uniforms.time>1&&(o.uniforms.time=0,e.filters=[],e.removeEventListener(egret.Event.ENTER_FRAME,r,n),t&&i&&t.call(i))};e.addEventListener(egret.Event.ENTER_FRAME,r,this)},e.setLightFlowFilter=function(e,t){if(void 0===t&&(t=!0),t){var i=new egret.CustomFilter(this.vertexSrc,this.fragmentSrc_lightFlow,{customUniform:0});e.filters=[i];var n=function(){i.uniforms.customUniform+=.15,i.uniforms.customUniform>2*Math.PI&&(i.uniforms.customUniform=0)};e.addEventListener(egret.Event.ENTER_FRAME,n,this)}else e.filters=[]},e.vertexSrc="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aColor;\nuniform vec2 projectionVector;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nconst vec2 center = vec2(-1.0, 1.0);\nvoid main(void) {\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.x, aColor.x, aColor.x, aColor.x);\n}",e.fragmentSrc_lightFlow="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\nuniform float customUniform;\nvoid main(void) {\nvec2 uvs = vTextureCoord.xy;\nvec4 fg = texture2D(uSampler, vTextureCoord);\nfg.rgb += sin(customUniform + uvs.x * 5. + uvs.y * 2.) * 0.1;\ngl_FragColor = fg * vColor;\n}",e.fragmentSrc_waterRipple=["precision lowp float;\nvarying vec2 vTextureCoord;","varying vec4 vColor;\n","uniform sampler2D uSampler;","uniform vec2 center;","uniform vec3 params;","uniform float time;","void main()","{","vec2 uv = vTextureCoord.xy;","vec2 texCoord = uv;","float dist = distance(uv, center);","if ( (dist <= (time + params.z)) && (dist >= (time - params.z)) )","{","float diff = (dist - time);","float powDiff = 1.0 - pow(abs(diff*params.x), params.y);","float diffTime = diff  * powDiff;","vec2 diffUV = normalize(uv - center);","texCoord = uv + (diffUV * diffTime);","}","gl_FragColor = texture2D(uSampler, texCoord);","}"].join("\n"),e}();e.FilterUtil=t,__reflect(t.prototype,"game.FilterUtil")}(game||(game={}));var game;!function(e){var t=function(){function t(){}return t.sendRequest=function(t,i,n,o){var r=this;return void 0===t&&(t="GET"),new Promise(function(s,a){var u=new XMLHttpRequest;if(u.open(t,i),o)for(var h in o)u.setRequestHeader(h,o[h]);u.onreadystatechange=function(){if(4==u.readyState)switch(u.status){case 200:case 201:case 204:try{var e=JSON.parse(u.responseText);e&&0==e.code?s(e):a()}catch(t){a()}break;default:a()}},u.onerror=function(t){e.StageUtil.stage.addChild(new e.ErrTip("网络错误",function(){location.reload()},r)),a()},n?u.send(n):u.send()})},t}();e.HttpUtil=t,__reflect(t.prototype,"game.HttpUtil")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e}();e.StageUtil=t,__reflect(t.prototype,"game.StageUtil")}(game||(game={}));var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){},egret.lifecycle.onResume=function(){};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),game.StageUtil.stage=this.stage,this.stage.mask=new egret.Rectangle(0,0,1920,1080),window.urlParams.game_host&&(game.GlobalConfig.host=decodeURIComponent(window.urlParams.game_host)),window.urlParams.game_user_id&&(game.GlobalConfig.gameUserID=window.urlParams.game_user_id),window.urlParams.verify_code&&(game.GlobalConfig.verifyCode=window.urlParams.verify_code),this.loadResource()},t.prototype.resize=function(){this.stage.stageWidth/this.stage.stageHeight>16/9?this.stage.scaleMode=egret.StageScaleMode.FIXED_HEIGHT:this.stage.scaleMode=egret.StageScaleMode.FIXED_WIDTH},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t,i=this;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),e=new LoadingUI,this.stage.addChild(e),[4,e.createView()];case 1:return n.sent(),[4,RES.loadConfig("resource/default.res.json","resource/")];case 2:return n.sent(),[4,this.loadTheme()];case 3:return n.sent(),Promise.all([game.GameService.getInstance().login(),RES.loadGroup("preload",0,e)]).then(function(){i.stage.removeChild(e),i.createGameScene()})["catch"](function(e){console.log("用户初始化失败",e),i.stage.addChild(new game.ErrTip("没连上，刷新一下",function(){location.reload()},i))}),[3,5];case 4:return t=n.sent(),console.log("aaaaaaaaaaa"),console.error(t),[3,5];case 5:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,i){var n=new eui.Theme("resource/default.thm.json",e.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){this.gameScene=new game.GameScene,this.gameScene.percentWidth=100,this.gameScene.percentHeight=100,this.addChild(this.gameScene)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var game;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(e.BaseVO);e.ChooseBuffVO=t,__reflect(t.prototype,"game.ChooseBuffVO")}(game||(game={}));var LoadingUI=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.createView=function(){var e=this,t=[{url:"resource/img/load/loading.jpg",texture:null},{url:"resource/img/load/bar2.png",texture:null},{url:"resource/img/load/bar1.png",texture:null},{url:"resource/img/load/light.png",texture:null}],i=[];t.forEach(function(t){i.push(new Promise(function(i,n){var o=new egret.ImageLoader;o.once(egret.Event.COMPLETE,function(e){var n=new egret.Texture;n.bitmapData=e.target.data,t.texture=n,i()},e),o.load(t.url)}))});var n=function(e,t,i,n,o,r){var s=new eui.Image(e);return t.addChild(s),s.horizontalCenter=i,s.verticalCenter=n,o&&(s.width=o),o&&(s.height=r),s};return Promise.all(i).then(function(){n(t[0].texture,e,0,0),n(t[1].texture,e,0,325),e.addChild(e.group=new eui.Group),e.group.left=-534,e.group.bottom=205,e.group.width=996,e.group.height=20,n(t[2].texture,e.group,0,0),n(t[3].texture,e.group,423,0);var i=n(t[1].texture,e,0,325,996,20);e.addChild(i),e.group.mask=i,e.progressTxt=new eui.Label,e.progressTxt.horizontalCenter=0,e.progressTxt.verticalCenter=277,e.progressTxt.width=200,e.progressTxt.text="Loading...",e.progressTxt.textColor=10850643,e.progressTxt.verticalAlign="middle",e.progressTxt.size=45,e.addChild(e.progressTxt)})},t.prototype.onProgress=function(e,t){var i=this,n=e/t,o=Math.floor(996*n);if(this.group.left=-534+o,this.interval){if(n>=1)return void clearInterval(this.interval)}else{var r=["Loading","Loading.","Loading..","Loading..."],s=0;this.interval=setInterval(function(e){i.progressTxt.text=r[s],s>=3?s=0:s++},200)}},t}(eui.Component);__reflect(LoadingUI.prototype,"LoadingUI");var game;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(e.BaseVO);e.SpinVO=t,__reflect(t.prototype,"game.SpinVO")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e.testUser=2,e.gameUserID=1==e.testUser?276064:363048,e.verifyCode=1==e.testUser?3841095:4730318,e.defaultUserName=1==e.testUser?"sj04":"sj05",e.defaultUserNameJoin=1==e.testUser?"BZB_sj04":"BZB_sj05",e.host="https://4oi868q8qh.execute-api.ap-southeast-1.amazonaws.com/N243/games/42001",e.skinPath="resource/skins/game_skins/",e.musicSwitch=!0,e.effectSwitch=!0,e.fastSwitch=!1,e}();e.GlobalConfig=t,__reflect(t.prototype,"game.GlobalConfig")}(game||(game={}));var game;!function(e){var t;!function(e){e[e.BET=0]="BET",e[e.SPINNING=1]="SPINNING",e[e.STOP=2]="STOP",e[e.SHOW_RESULT=3]="SHOW_RESULT",e[e.SHOW_SINGLE_LINES=4]="SHOW_SINGLE_LINES"}(t=e.GameState||(e.GameState={}))}(game||(game={}));var game;!function(e){var t;!function(e){e[e.spin=0]="spin",e[e.cancelSpin=1]="cancelSpin",e[e.cancelAutoSpin=2]="cancelAutoSpin",e[e.betLevelIndex=3]="betLevelIndex",e[e.openHelp=4]="openHelp",e[e.openSetting=5]="openSetting",e[e.chooseFreeBack=6]="chooseFreeBack",e[e.freeComplete=7]="freeComplete",e[e.updateBgm=8]="updateBgm"}(t=e.NotifyConst||(e.NotifyConst={}))}(game||(game={}));var game;!function(e){var t=function(){function t(){}return t.getInstance=function(){return this._instance?this._instance:this._instance=new t},t.prototype.login=function(){var t=this;return new Promise(function(i,n){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t){try{e.HttpUtil.sendRequest("POST","https://xbbw2jfb58.execute-api.ap-southeast-1.amazonaws.com/dev/game/login",'{"userName":"'+e.GlobalConfig.defaultUserName+'","userPwd":"123456","userId":"32ecc451-4950-4a2e-8e75-520fa8113dd1"}').then(function(t){e.HttpUtil.sendRequest("POST","https://xbbw2jfb58.execute-api.ap-southeast-1.amazonaws.com/dev/game/player/join",'{"userName":"'+e.GlobalConfig.defaultUserNameJoin+'","gameId":"40000","sid":"42001","authCode":123456}',{Authorization:t.data.token}).then(i)})}catch(o){n("login join err")}return[2]})})})},t}();e.DefaultUser=t,__reflect(t.prototype,"game.DefaultUser")}(game||(game={}));var game;!function(e){var t=function(){function t(){}return t.getInstance=function(){return this._instance?this._instance:this._instance=new t},t.prototype.login=function(){var t=this;return new Promise(function(i,n){return __awaiter(t,void 0,void 0,function(){var t,o,r=this;return __generator(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),t=window.isDebug,t?[4,e.DefaultUser.getInstance().login()]:[3,2];case 1:t=s.sent(),s.label=2;case 2:return this.requestInitData().then(function(e){console.log("login resp ",e),r.loginVo=e,r.token=e.payload.token,0==e.code?i(e):n("auth code err")})["catch"](function(){n("login err")}),[3,4];case 3:return o=s.sent(),console.log("22222222222222"),n("default login err"),[3,4];case 4:return[2]}})})})},t.prototype.requestInitData=function(){return new Promise(function(t,i){e.HttpUtil.sendRequest("POST",e.GlobalConfig.host+"/authuser",'{"GameUserID":'+e.GlobalConfig.gameUserID+',"VerifyCode":'+e.GlobalConfig.verifyCode+"}").then(function(e){t(e)})["catch"](function(){i("auth error")})})},t.prototype.sendSpin=function(t,i){var n=this;return new Promise(function(o,r){e.HttpUtil.sendRequest("POST",e.GlobalConfig.host+"/spin"+(i?"?hotkey="+i:""),'{"betLevel":'+t+',"multiLevel":0}',{Authorization:"Bearer "+n.token}).then(o)["catch"](r)})},t.prototype.sendFreeChoose=function(t){var i=this;return new Promise(function(n,o){e.HttpUtil.sendRequest("POST",e.GlobalConfig.host+"/choosebuff",'{"buff":'+t+"}",{Authorization:"Bearer "+i.token}).then(n)["catch"](o)})},t}();e.GameService=t,__reflect(t.prototype,"game.GameService")}(game||(game={}));var game;!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.winNum=0,i.skinName=e.GlobalConfig.skinPath+"bigWinSkin.exml",i}return __extends(i,t),i.prototype.init=function(){this.visible=!1,this.yuanbaoTime=[1e4,2e4,3e4],this.yuanbaoNum=[30,60,90]},i.prototype.bigWinStart=function(t,i){var n=this;this.visible=!0;var o=this.yuanbaoTime[0];switch(t){case"big":o=this.yuanbaoTime[0];break;case"mega":o=this.yuanbaoTime[1];break;case"super":o=this.yuanbaoTime[2]}return this.winChannel=e.SoundPlayer.playEffect("CaiShen_243_BigWin_mp3"),this.bigWinLight(),Promise.all([this.payOut(i,o),this.winTxtAni(t)]).then(function(){n.winChannel&&n.winChannel.stop()})},i.prototype.yuanbao=function(e,t){var i=this;return new Promise(function(n,o){var r=RES.getRes("yigeyuanb_png"),s=RES.getRes("particle_yuanbao_json");s.maxParticles=t,i.theParticle=new particle.GravityParticleSystem(r,s),i.yuanbaoGroup.addChild(i.theParticle),i.theParticle.start();var a;a&&clearTimeout(a),a=setTimeout(function(){i.theParticle&&i.theParticle.stop(),i.theParticle.parent.removeChild(i.theParticle),i.theParticle=null,n()},e)})},i.prototype.winTxtAni=function(e){var t=this;return new Promise(function(i,n){var o=function(e){t.winImg.source=e,egret.Tween.get(t.winImg).to({scaleX:5,scaleY:5},200).to({scaleX:1,scaleY:1},200).call(function(){egret.Tween.removeTweens(t.winImg)})};o("BigWin_png");var r=t.yuanbaoTime[1]-t.yuanbaoTime[0],s=t.yuanbaoTime[2]-t.yuanbaoTime[1];switch(e){case"big":t.yuanbao(t.yuanbaoTime[0],t.yuanbaoNum[0]).then(function(){t.visible=!1,i()});break;case"mega":t.yuanbao(t.yuanbaoTime[0],t.yuanbaoNum[0]).then(function(){o("MegaWin_png"),t.yuanbao(r,t.yuanbaoNum[1]).then(function(){t.visible=!1,i()})});break;case"super":t.yuanbao(t.yuanbaoTime[0],t.yuanbaoNum[0]).then(function(){o("MegaWin_png"),t.yuanbao(r,t.yuanbaoNum[1]).then(function(){o("SuperWin_png"),t.yuanbao(s,t.yuanbaoNum[2]).then(function(){t.visible=!1,i()})})})}})},i.prototype.payOut=function(t,i){var n=this;return this.winNum=0,new Promise(function(o,r){egret.Tween.get(n,{onChange:function(){n.payout.text=n.winNum.toFixed(2)},onChangeObj:n}).to({winNum:t},i-2e3).call(function(){egret.Tween.removeTweens(n),e.SoundPlayer.playEffect("CaiShen_243_BigWinOver_mp3"),egret.Tween.get(n.payout).to({scaleX:1.2,scaleY:1.2},300).to({scaleX:1,scaleY:1},300).call(function(){egret.Tween.removeTweens(n.payout),n.fireworks(),o()})})})},i.prototype.bigWinLight=function(){this.light.sources="bigwinLight|1-30|_png",this.light.play()},i.prototype.fireworks=function(){var e=this;return new Promise(function(t,i){for(var n=RES.getRes("fireworks_png"),o=RES.getRes("particle_fireworks_json"),r=Math.ceil(30*Math.random()),s=[],a=0;r>=a;a++){var u=new particle.GravityParticleSystem(n,o);u.blendMode=egret.BlendMode.ADD,s.push(u),e.payoutGroup.addChild(u);200-400*Math.floor(Math.random());u.emitterX=1250-Math.floor(600*Math.random()),u.emitterY=680-Math.floor(300*Math.random()),u.start()}var h;h&&clearTimeout(h),h=setTimeout(function(){s.forEach(function(e){return e.stop()}),t()},80)})},i}(e.BaseUI);e.BigWin=t,__reflect(t.prototype,"game.BigWin")}(game||(game={}));var game;!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.winNum=0,i.skinName=e.GlobalConfig.skinPath+"bottomSkin.exml",i}return __extends(i,t),i.prototype.setFree=function(e){this.isFree=e,this.isAuto=e,this.autoImg.source=this.isFree?"Free_png":"Auto_1_png",this.autoState()},i.prototype.init=function(){this.initData(),this.eventListen()},i.prototype.initData=function(){this.isAuto=!1,this.isFree=!1},i.prototype.eventListen=function(){var t=this;this.registerEvent(this.spinBtn,egret.TouchEvent.TOUCH_TAP,function(){t.isAuto?t.sendNotify(e.NotifyConst.cancelSpin):(e.SoundPlayer.playEffect("CaiShen_243_Spin_mp3"),t.sendNotify(e.NotifyConst.spin),t.imgSpin(),t.setWinMoney(0),t.hideCutGroup(!0))},this),this.registerEvent(this.stopSpinBtn,egret.TouchEvent.TOUCH_TAP,function(){t.sendNotify(e.NotifyConst.cancelSpin)},this),this.registerEvent(this.helpBtn,egret.TouchEvent.TOUCH_TAP,function(){t.sendNotify(e.NotifyConst.openHelp,t.theBetArr[t.theBetIndex]),t.hideCutGroup()},this),["max","100","50","20","10"].forEach(function(e){t.registerEvent(t["btn_"+e],egret.TouchEvent.TOUCH_TAP,t.touchAutoNum,t)}),this.registerEvent(this.betBtn,egret.TouchEvent.TOUCH_TAP,this.chooseBetLevel,this),this.registerEvent(this.autoBtn,egret.TouchEvent.TOUCH_TAP,this.touchAuto,this),this.registerEvent(this.cancelAutoBtn,egret.TouchEvent.TOUCH_TAP,this.touchCancelAuto,this),this.registerEvent(this.BtnLess,egret.TouchEvent.TOUCH_TAP,this.reduceBetLevel,this),this.registerEvent(this.BtnMore,egret.TouchEvent.TOUCH_TAP,this.addBetLevel,this),this.registerEvent(this.BtnMax,egret.TouchEvent.TOUCH_TAP,this.maxBetLevel,this)},i.prototype.showTween=function(e,t){return new Promise(function(i,n){egret.Tween.get(e).to({bottom:t},400).call(function(){egret.Tween.removeTweens(e),i()})})},i.prototype.touchAutoNum=function(t){var i=this,n=t.target.name.split("_")[1];this.sendNotify(e.NotifyConst.spin,n),"max"==n?this.setAutoBetNum(-1):this.setAutoBetNum(+n),this.showAutoBtn(!1),this.isAuto=!0,this.showTween(this.groupAutoNum,-400).then(function(){return i.groupAutoNum.visible=!1}),this.autoState()},i.prototype.showAutoBtn=function(e){this.autoBtn.visible=e,this.cancelAutoBtn.visible=!e},i.prototype.chooseBetLevel=function(){var t=this,i=function(){t.hideCutGroup(),t.groupBet.visible=!0,t.showTween(t.groupBet,126).then(function(){return e.SoundPlayer.playEffect("CaiShen_243_GUI_Generic1_mp3")})};this.groupBet.visible?this.showTween(this.groupBet,-100).then(function(){t.groupBet.visible=!1,e.SoundPlayer.playEffect("CaiShen_243_GUI_Generic2_mp3")}):i()},i.prototype.checkPlusReduceState=function(){this.BtnLess.enabled=0!=this.theBetIndex,this.BtnMore.enabled=this.theBetIndex!=this.theBetArr.length-1,this.betTxt.text=this.theBetArr[this.theBetIndex].toFixed(2),this.theBet.text="单注："+this.theBetArr[this.theBetIndex].toFixed(2),this.allBet.text="总押注："+(this.theBetArr[this.theBetIndex]*this.theBetMulit).toFixed(2),this.sendNotify(e.NotifyConst.betLevelIndex,this.theBetIndex)},i.prototype.addBetLevel=function(){e.SoundPlayer.playEffect("CaiShen_243_GUI_Generic1_mp3"),this.theBetIndex<this.theBetArr.length-1&&this.theBetIndex++,this.checkPlusReduceState()},i.prototype.reduceBetLevel=function(){e.SoundPlayer.playEffect("CaiShen_243_GUI_Generic1_mp3"),this.theBetIndex>0&&this.theBetIndex--,this.checkPlusReduceState()},i.prototype.maxBetLevel=function(){e.SoundPlayer.playEffect("CaiShen_243_GUI_Generic1_mp3"),this.theBetIndex=this.theBetArr.length-1,this.checkPlusReduceState()},i.prototype.touchAuto=function(){var t=this,i=function(){t.hideCutGroup(),t.groupAutoNum.visible=!0,t.showTween(t.groupAutoNum,107).then(function(){return e.SoundPlayer.playEffect("CaiShen_243_GUI_Generic1_mp3")})};this.groupAutoNum.visible?this.showTween(this.groupAutoNum,-400).then(function(){t.groupAutoNum.visible=!1,e.SoundPlayer.playEffect("CaiShen_243_GUI_Generic2_mp3")}):i()},i.prototype.hideCutGroup=function(t){var i=this;void 0===t&&(t=!1),this.groupBet.visible&&this.showTween(this.groupBet,-100).then(function(){i.groupBet.visible=!1,t&&e.SoundPlayer.playEffect("CaiShen_243_GUI_Generic2_mp3")}),this.groupAutoNum.visible&&this.showTween(this.groupAutoNum,-400).then(function(){i.groupAutoNum.visible=!1,t&&e.SoundPlayer.playEffect("CaiShen_243_GUI_Generic2_mp3")})},i.prototype.touchCancelAuto=function(){this.sendNotify(e.NotifyConst.cancelAutoSpin),this.isAuto=!1,this.showAutoBtn(!0)},i.prototype.autoState=function(){this.spinArrow.visible=!this.isAuto,this.stopSpinBtn.visible=!this.isAuto,this.groupAuto.visible=this.isAuto},i.prototype.payout=function(e){var t=this;this.winNum=0,egret.Tween.get(this,{onChange:function(){t.winTxt.text=t.winNum.toFixed(2)},onChangeObj:this}).to({winNum:e},800).call(function(){egret.Tween.removeTweens(t)}),egret.Tween.get(this.winTxt).to({scaleX:1.5,scaleY:1.5},400).to({scaleX:1,scaleY:1},400).call(function(){egret.Tween.removeTweens(t.winTxt)});var i=function(e,t,i,n){e.visible=!0,e.alpha=0,egret.Tween.get(e).to({alpha:t[0]},i).to({alpha:t[1]},i).call(function(){n&&(egret.Tween.removeTweens(e),e.visible=!1)}).to({alpha:t[2]},i).to({alpha:t[3]},i).call(function(){egret.Tween.removeTweens(e),e.visible=!1})};i(this.winLight,[1,.5,1,0],200),i(this.btmLight,[.7,0],400,!0)},i.prototype.imgSpin=function(e){void 0===e&&(e=!1),e?egret.Tween.removeTweens(this.spinArrow):egret.Tween.get(this.spinArrow).to({rotation:360},500)},i.prototype.setBetData=function(e,t,i){e&&(this.theBetArr=e),void 0!=t&&(this.theBetIndex=t),void 0!=i&&(this.theBetMulit=i),this.checkPlusReduceState()},i.prototype.setWinMoney=function(e){e&&(this.winTxt.text=e+"",this.payout(e))},i.prototype.setState=function(t){var i=this;this.state=t;var n=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),i.betBtn.enabled=e,i.autoBtn.enabled=t},o=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),i.spinBtn.visible=i.isAuto?!0:e,i.spinBtn.enabled=t,i.stopSpinBtn.visible=i.isAuto?!1:!e,i.spinArrow.visible=i.isAuto?!1:e};switch(this.autoState(),t){case e.GameState.BET:n(),o();break;case e.GameState.SPINNING:this.winTxt.text="0.00",n(!1,!1),o(!0,!1),this.isAuto&&(this.spinBtn.enabled=!1);break;case e.GameState.SHOW_RESULT:n(!1),o(!0,!1),this.isAuto&&(this.spinBtn.enabled=!1);break;case e.GameState.STOP:case e.GameState.SHOW_SINGLE_LINES:n(!1,!1),this.imgSpin(!0),o(!1),this.isAuto&&(this.spinBtn.enabled=!0)}},i.prototype.setAutoBetNum=function(e){this.showAutoBtn(0==e),this.isAuto=0!=e,this.autoNum.text=e>=0?e+"":"MAX"},i.prototype.dispose=function(){t.prototype.dispose.call(this)},i}(e.BaseUI);e.BottomBar=t,__reflect(t.prototype,"game.BottomBar")}(game||(game={}));var game;!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.skinName=e.GlobalConfig.skinPath+"connectTipSkin.exml",i}return __extends(i,t),i.prototype.init=function(){},i.prototype.show=function(e){this.visible=e,e?egret.Tween.get(this.circle,{loop:!0}).to({rotation:360},1e3,egret.Ease.circInOut):egret.Tween.removeTweens(this.circle)},i}(e.BaseUI);e.ConnectTip=t,__reflect(t.prototype,"game.ConnectTip")}(game||(game={}));var game;!function(e){var t=function(t){function i(i,n,o){var r=t.call(this)||this;return r.skinName=e.GlobalConfig.skinPath+"errSkin.exml",r.errTxt.text=i,r.visible=!0,r.sureBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){r.parent&&r.parent.removeChild(r),n&&n.call(o),r.visible=!1,r.parent.removeChild(r)},r),r}return __extends(i,t),i}(eui.Component);e.ErrTip=t,__reflect(t.prototype,"game.ErrTip")}(game||(game={}));var game;!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.skinName=e.GlobalConfig.skinPath+"freeChooseSkin.exml",i}return __extends(i,t),i.prototype.init=function(){var e=this;this.yuanbaoGroup.visible=!1,["20","15","10","8","5"].forEach(function(t,i){e.registerEvent(e["choose"+t],egret.TouchEvent.TOUCH_TAP,e.onTouch,e)})},i.prototype.show=function(){var t=this;this.yuanbaoGroup.visible=!1,this.chooseGroup.setChildIndex(this.rect,0),["10","5","15","8","20"].forEach(function(e,i){t.chooseGroup.setChildIndex(t["choose"+e],1)}),["20","8","15","5","10"].forEach(function(i,n){var o=t["choose"+i],r=o.y;egret.Tween.get(o).set({y:r-1e3}).wait(100*n+500).call(function(){e.SoundPlayer.playEffect("CaiShen_243_CardAppear_mp3")}).to({y:r+50},200).to({y:r},30).call(function(){t.registerEvent(o,egret.TouchEvent.TOUCH_TAP,t.onTouch,t)})}),egret.Tween.get(this.tipTxt,{loop:!0}).wait(2e3).to({alpha:.5},500).to({alpha:1},500)},i.prototype.onTouch=function(t){var i=this;e.SoundPlayer.playEffect("CaiShen_243_ChoseCard_mp3");var n=0;switch(t.target){case this.choose20:n=5;break;case this.choose15:n=4;break;case this.choose10:n=3;break;case this.choose8:n=2;break;case this.choose5:n=1}["20","15","10","8","5"].forEach(function(o){var r=i["choose"+o];if(t.target!=r)i.chooseGroup.setChildIndex(r,0);else{var s;Promise.all([new Promise(function(t,n){var o=new e.AMovieClip;o.sources="caishenAni|1-16|_png",o.x=94,o.y=67,o.width=319,o.height=321,o.speed=4,o.loop=2,r.addChildAt(o,2),o.play(),o.once(e.AMovieClip.COMPLETE,function(){o.parent.removeChild(o),t()},i)}),new Promise(function(t,o){n>0&&e.GameService.getInstance().sendFreeChoose(n).then(function(e){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(i){return s=e,t(),[2]
})})})})]).then(function(){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.yuanbaoAni()];case 1:return t.sent(),this.sendNotify(e.NotifyConst.chooseFreeBack,s),[2]}})})})}})},i.prototype.yuanbaoAni=function(){e.SoundPlayer.playEffect("CaiShen_243_CardEffect_mp3"),egret.Tween.removeTweens(this.tipTxt);var t=this.yuanbaoGroup,i=[];t.visible=!0;for(var n=t.numChildren-1;n>=0;n--)t.getChildAt(n).alpha=0,i.push(t.getChildAt(n));return Promise.all(i.map(function(e,t){return new Promise(function(i,n){setTimeout(function(){egret.Tween.get(e).to({alpha:1},200).wait(500).call(function(){egret.Tween.removeTweens(e),i()})},200*t)})}))},i}(e.BaseUI);e.FreeChoose=t,__reflect(t.prototype,"game.FreeChoose")}(game||(game={}));var game;!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.num=0,i.skinName=e.GlobalConfig.skinPath+"freeTotalWinSkin.exml",i}return __extends(i,t),i.prototype.init=function(){},i.prototype.showTotalWin=function(t){e.SoundPlayer.playEffect("CaiShen_243_FreeOver_mp3"),this.visible=!0,this.win=+t,this.num=0,egret.Tween.get(this,{onChange:this.onChange,onChangeObj:this}).to({num:+t},2e3).call(this.stop),this.registerEvent(this,egret.TouchEvent.TOUCH_TAP,this.stop,this)},i.prototype.onChange=function(){this.winTxt.text=this.num.toFixed(2)},i.prototype.stop=function(){var t=this;egret.Tween.removeTweens(this),this.winTxt.text=this.win.toFixed(2),egret.Tween.get(this.winTxt).to({scaleX:1.2,scaleY:1.2},300).to({scaleX:1,scaleY:1},300).wait(2e3).call(function(){egret.Tween.removeTweens(t.winTxt),t.sendNotify(e.NotifyConst.freeComplete)})},i}(e.BaseUI);e.FreeTotalWin=t,__reflect(t.prototype,"game.FreeTotalWin")}(game||(game={}));var game;!function(e){var t=function(t){function n(){var i=t.call(this)||this;return i.nextFree=!1,i.nextBonus=!1,i.buff="-1",i.skinName=e.GlobalConfig.skinPath+"gameSceneSkin.exml",i}return __extends(n,t),n.prototype.init=function(){this.initView(),this.initData()},n.prototype.initView=function(){this.initTitle(),this.initSymbols(),this.tileGroup.mask=this.tileMask,this.setState(e.GameState.BET),this.initVisible(),this.initListener()},n.prototype.initTitle=function(){this.title.play()},n.prototype.initSymbols=function(){this.symbols=[];for(var e=0;15>e;e++)this.symbols.push(new i(this["tile"+e],this));for(var e=0;15>e;e++){var t=Math.floor(13*Math.random())+"";(3>e||e>11)&&"1"==t&&(t="2"),t="1"==t?"1_1":t,this["tile"+e].visible=!0,this["tile"+e].source="symbolName_"+t+"_png"}},n.prototype.initVisible=function(){[this.border2,this.border3,this.border4,this.lineWinTxt].forEach(function(e){e.visible=!1});for(var e=0;20>e;e++)this["vagueTile"+e].visible=!1},n.prototype.initListener=function(){var e=this;this.registerEvent(this.testBtn,egret.TouchEvent.TOUCH_TAP,function(){e.nextFree=!0},this),this.registerEvent(this.testBtn1,egret.TouchEvent.TOUCH_TAP,function(){e.nextBonus=!0},this),this.registerEvent(this.bg,egret.TouchEvent.TOUCH_TAP,function(){e.bottomBar.hideCutGroup(!0)},this)},n.prototype.updateBgm=function(){this.isFree?e.SoundPlayer.playMusic("CaiShen_243_freeGame_mp3"):this.freeChoose.visible?e.SoundPlayer.playMusic("CaiShen_243_featureChoose_mp3"):e.SoundPlayer.playMusic("CaiShen_243_normalGame_mp3")},n.prototype.initData=function(){e.NotifyManager.getInstance().addRegister(this,[e.NotifyConst.spin,e.NotifyConst.openHelp,e.NotifyConst.openSetting,e.NotifyConst.cancelSpin,e.NotifyConst.cancelAutoSpin,e.NotifyConst.betLevelIndex,e.NotifyConst.chooseFreeBack,e.NotifyConst.freeComplete,e.NotifyConst.updateBgm]);var t=e.GameService.getInstance().loginVo;this.balance=+t.payload.userBalance,this.betcfg=t.payload.betcfg,this.betLevel=t.payload.betLevel,this.multicfg=t.payload.multicfg,this.multiLevel=t.payload.multiLevel,this.topBar.setUser(t.payload.nickname),this.topBar.setBalance(t.payload.userBalance),this.theBalance=t.payload.userBalance,this.bottomBar.setBetData(this.betcfg,this.betLevel,this.multicfg[this.multiLevel]),this.checkDataRecover(t),this.setting.defaultOpen()},n.prototype.checkDataRecover=function(e){e.payload.featureData&&(e.payload.featureData.freeSpinRemainCount>0?(this.isFree=!0,this.bottomBar.setFree(!0),this.buff=e.payload.featureData.buff,this.freeSpinRemainCount=e.payload.featureData.freeSpinRemainCount,this.featureChanceCount=e.payload.featureData.featureChanceCount,this.showFreeChoose(!1),this.showFreeGame(!0),this.bottomBar.setAutoBetNum(this.freeSpinRemainCount)):e.payload.featureData.featureChanceCount>0?(this.showFreeChoose(!0),this.showFreeGame(!1),this.freeSpinRemainCount=e.payload.featureData.freeSpinRemainCount,this.featureChanceCount=e.payload.featureData.featureChanceCount):(this.showFreeChoose(!1),this.showFreeGame(!1),this.freeSpinRemainCount=0,this.featureChanceCount=0))},n.prototype.handleNotify=function(t,i){var n=this;switch(t){case e.NotifyConst.spin:this.spin(i);break;case e.NotifyConst.openHelp:this.rull.rullShow(i,!0);break;case e.NotifyConst.openSetting:this.setting.settingShow();break;case e.NotifyConst.cancelSpin:this.state==e.GameState.STOP?this.cancelSpin():this.state==e.GameState.SHOW_SINGLE_LINES&&this.cancelLinesWin();break;case e.NotifyConst.cancelAutoSpin:this.autoMax=!1,this.autoCount=0;break;case e.NotifyConst.betLevelIndex:this.betLevel=i;break;case e.NotifyConst.chooseFreeBack:this.freeSpinRemainCount=i.payload.featureData.freeSpinRemainCount,this.buff=i.payload.featureData.buff,this.featureChanceCount--,this.isFree=!0,this.bottomBar.setFree(!0),this.bottomBar.setAutoBetNum(this.freeSpinRemainCount),this.showFreeChoose(!1),this.showFreeGame(!0);break;case e.NotifyConst.freeComplete:egret.Tween.get(this).to({alpha:0},700).wait(700).call(function(){n.freeTotalWin.visible=!1,n.freeComplete()}).to({alpha:1},700);break;case e.NotifyConst.updateBgm:this.updateBgm()}},n.prototype.setState=function(e){this.state=e,this.bottomBar.setState(e)},n.prototype.spin=function(t){if(this.balance<this.betcfg[this.betLevel]*this.multicfg[this.multiLevel])return console.log("余额不足"),void this.stage.addChild(new e.ErrTip("余额不足",function(){},this));var i=(+this.theBalance-this.betcfg[this.betLevel]*this.multicfg[this.multiLevel]).toFixed(2);this.topBar.setBalance(i),"max"==t?this.autoMax=!0:t>0&&(this.autoMax=!1,this.autoCount=t),this.spinResp&&(this.buff=this.spinResp.payload.featureData.buff),this.startSpin(),this.nextFree?e.GameService.getInstance().sendSpin(this.betLevel,"1").then(this.spinBack.bind(this)):this.nextBonus?e.GameService.getInstance().sendSpin(this.betLevel,"3").then(this.spinBack.bind(this)):e.GameService.getInstance().sendSpin(this.betLevel).then(this.spinBack.bind(this)),this.nextFree=!1,this.nextBonus=!1,this.isReturnData=!1,this.setState(e.GameState.SPINNING),this.showConnect()},n.prototype.showConnect=function(){var t=this,i=function(e){return new Promise(function(i,n){t.spinWain&&clearTimeout(t.spinWain),t.spinWain=setTimeout(function(){return i()},e)})};i(12e3).then(function(){t.isReturnData||t.connectTip.show(!0),i(8e3).then(function(){t.isReturnData||(t.connectTip.show(!1),t.stage.addChild(new e.ErrTip("网络连接错误，是否重连?",function(){return location.reload()},t)))})})},n.prototype.spinBack=function(t){var i=this;if(t.payload.winGrid.length>0&&t.payload.winGrid.forEach(function(e,t){for(var i=e.winCard.length-1;i>=0;i--)-1==e.winCard[i]&&e.winCard.splice(i,1);for(var n=e.line.length-1;n>=0;n--)-1==e.line[n]&&e.line.splice(n,1)}),t.payload.scatterGrid.length>0)for(var n=t.payload.scatterGrid.length-1;n>=0;n--)-1==t.payload.scatterGrid[n]&&t.payload.scatterGrid.splice(n,1);console.log("UI收到spin返回 ",t),this.spinResp=t,this.isFree&&(this.freeSpinRemainCount=this.spinResp.payload.featureData.freeSpinRemainCount,this.featureChanceCount=this.spinResp.payload.featureData.featureChanceCount,this.featureMultiplier=this.spinResp.payload.featureData.featureMultiplier),this.stopRoll(t.payload.viewGrid).then(function(){var e=t.payload.userBalance;i.topBar.setBalance(e,t.payload.totalGold),i.theBalance=e}),this.setState(e.GameState.STOP),this.isReturnData=!0,this.connectTip.visible&&this.connectTip.show(!1)},n.prototype.startSpin=function(){this.rollChannel=e.SoundPlayer.playEffect("CaiShen_243_Roll_mp3",-1);for(var t=0;15>t;t++)this["tile"+t].visible=!1;for(var t=0;5>t;t++)this.singleColumRoll(t);this.thePArr&&this.thePArr.length>0&&this.freeMultiAni(this.featureMultiplier,!1)},n.prototype.singleColumRoll=function(t){for(var i=this,n=0;4>n;n++)this["vagueTile"+(4*t+n)].visible=!0,this["vagueTile"+(4*t+n)].source="vague"+Math.floor(11*Math.random()+2)+"_png";egret.Tween.get(this["vagueTile"+4*t],{loop:!0}).wait(20).call(function(){for(var n=0;4>n;n++){var o=i["vagueTile"+(4*t+n)];o.y+=e.GlobalConfig.fastSwitch?104:80,o.y>658&&(o.y-=832,o.source="vague"+Math.floor(11*Math.random()+2)+"_png")}})},n.prototype.stopRoll=function(e){return __awaiter(this,void 0,void 0,function(){var t,i,n,o;return __generator(this,function(r){switch(r.label){case 0:this.rollChannel&&this.rollChannel.stop(),t=e.slice(0,3).indexOf("0")>-1&&e.slice(3,6).indexOf("0")>-1,i=t&&e.slice(6,9).indexOf("0")>-1,n=i&&e.slice(9,12).indexOf("0")>-1,o=0,r.label=1;case 1:return 5>o?2>o?[4,this.stopColumn(o,e.slice(3*o,3*o+3))]:[3,3]:[3,10];case 2:return r.sent(),[3,9];case 3:return 2!=o?[3,5]:[4,this.stopColumn(o,e.slice(3*o,3*o+3),t)];case 4:return r.sent(),[3,9];case 5:return 3!=o?[3,7]:[4,this.stopColumn(o,e.slice(3*o,3*o+3),i)];case 6:return r.sent(),[3,9];case 7:return 4!=o?[3,9]:[4,this.stopColumn(o,e.slice(3*o,3*o+3),n)];case 8:r.sent(),r.label=9;case 9:return o++,[3,1];case 10:return this.judgeResult(),[2]}})})},n.prototype.stopColumn=function(t,i,n){var o=this;return void 0===n&&(n=!1),new Promise(function(r,s){return __awaiter(o,void 0,void 0,function(){var o,s=this;return __generator(this,function(a){switch(a.label){case 0:return n?[4,this.freeEffect(t)]:[3,2];case 1:a.sent(),a.label=2;case 2:return egret.Tween.removeTweens(this["vagueTile"+4*t]),[0,1,2,3].forEach(function(e){s["vagueTile"+(4*t+e)].visible=!1,s["vagueTile"+(4*t+e)].y=21+208*e}),o=!1,[0,1,2].forEach(function(n){"0"==i[n]&&(o=!0);var a=s.symbols[3*t+n],u="1"==i[n]?"1"+("-1"==s.buff?"":"_"+s.buff):i[n],h=a.tile.y;a.tile.visible=!0,a.value=i[n],a.setTexture("symbolName_"+u+"_png"),egret.Tween.get(a.tile).set({y:h+100}).to({y:h},e.GlobalConfig.fastSwitch?150:250).wait(e.GlobalConfig.fastSwitch?50:200).call(function(){egret.Tween.removeTweens(a.tile),r()})}),o&&e.SoundPlayer.playEffect("CaiShen_243_Scatter_"+(t+1)+"_mp3"),e.SoundPlayer.playEffect("CaiShen_243_RollStop_mp3"),[2]}})})})},n.prototype.freeEffect=function(t){var i=this;return e.SoundPlayer.playEffect("CaiShen_243_Scatter_wait_mp3"),new Promise(function(n,o){i["border"+t].visible=!0,i["border"+t].play();var r=i["tile"+3*t].x+i["tile"+3*t].width/2,s=(i["tile"+3*t].y,new egret.DisplayObjectContainer);i.freeCoinsGroup.addChild(s);var a=[],u=function(){for(var n=0;4>n;n++){var o=new e.AMovieClip;o.sources="coin_pin_|1-9|_png",o.width=o.height=20,o.anchorOffsetX=10,o.anchorOffsetY=10,o.rotation=360*Math.random(),o.play(),o.speed=Math.round(6*Math.random()+3),o.alphaSpeed=Math.round(.02*Math.random()+.01),o.x=r+(.5-Math.random())*i["tile"+3*t].width,s.addChild(o),a.push(o)}},h=0;egret.Tween.get(i.freeCoinsGroup,{loop:!0}).wait(20).call(function(){h++%10==0&&u();for(var e=a.length-1;e>=0;e--){var t=a[e];t.rotation+=5,t.y+=t.speed,t.alpha-=t.alphaSpeed,t.y>=927&&(t.parent.removeChild(t),a.splice(e,1))}}),i.freeColumnTimeout&&clearTimeout(i.freeColumnTimeout),i.freeColumnTimeout=setTimeout(function(){for(egret.Tween.removeTweens(i.freeCoinsGroup);a.length>0;){var e=a.pop();e.parent.removeChild(e)}s.parent&&s.parent.removeChild(s),i["border"+t].stop(),i["border"+t].visible=!1,n()},2e3)})},n.prototype.cancelSpin=function(){this.freeColumnTimeout&&clearTimeout(this.freeColumnTimeout);for(var e=0;20>e;e++)egret.Tween.removeTweens(this["vagueTile"+e]),this["vagueTile"+e].visible=!1,this["vagueTile"+e].y=e%4*208+21;for(var t=this.spinResp.payload.viewGrid,e=0;15>e;e++){egret.Tween.removeTweens(this.symbols[e].tile),this.symbols[e].value=this.spinResp.payload.viewGrid[e],this.symbols[e].tile.visible=!0,this.symbols[e].tile.y=e%3*208+21;var i="1"==t[e]?"1"+("-1"==this.buff?"":"_"+this.buff):t[e];this.symbols[e].setTexture("symbolName_"+i+"_png")}this.border2.stop(),this.border3.stop(),this.border4.stop(),this.border2.visible=!1,this.border3.visible=!1,this.border4.visible=!1,egret.Tween.removeTweens(this.freeCoinsGroup),this.freeCoinsGroup.removeChildren(),this.judgeResult()},n.prototype.judgeResult=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return console.log("判定结果 中奖线"+this.spinResp.payload.winGrid.length),this.setState(e.GameState.SHOW_RESULT),[4,this.showBigWin(this.spinResp.payload.winLevel,this.spinResp.payload.totalGold)];case 1:return t.sent(),[4,this.showAllWinGrid(this.spinResp.payload.winGrid)];case 2:return t.sent(),[4,this.showScatterLine()];case 3:return t.sent(),[4,this.showFreeChange()];case 4:return t.sent(),[4,this.showBonusLine()];case 5:return t.sent(),this.isFree?[4,this.showEveryLineGrid(this.spinResp.payload.winGrid)]:[3,7];case 6:return t.sent(),0==this.freeSpinRemainCount?this.showFreeTotalWin(this.spinResp.payload.featureData.featureRoundGold):(this.setState(e.GameState.BET),this.spin(),this.bottomBar.setAutoBetNum(this.freeSpinRemainCount)),[3,10];case 7:return this.autoMax?this.bottomBar.setAutoBetNum(-1):this.autoCount>0&&this.bottomBar.setAutoBetNum(--this.autoCount),this.spinResp.payload.getFeatureChance?(this.showFreeChoose(!0),[3,10]):[3,8];case 8:return[4,this.showEveryLineGrid(this.spinResp.payload.winGrid)];case 9:t.sent(),this.setState(e.GameState.BET),(this.autoMax||this.autoCount>0)&&this.spin(),t.label=10;case 10:return[2]}})})},n.prototype.showBigWin=function(t,i){var n=this;return new Promise(function(o,r){0>=i?o():"normal"==t?(e.SoundPlayer.playEffect("CaiShen_243_SmallWin_mp3"),o()):"middle"==t?(e.SoundPlayer.playEffect("CaiShen_243_MiddleWin_mp3"),o()):n.bigWin.bigWinStart(t,i).then(function(){o()})})},n.prototype.showAllWinGrid=function(e){var t=this,i=[];return e.forEach(function(e){e.winCard.forEach(function(e,t){var n=e+3*t;-1!=e&&-1==i.indexOf(n)&&i.push(n)})}),this.bottomBar.setWinMoney(this.spinResp.payload.totalGold),i.some(function(e){return"1"==t.spinResp.payload.viewGrid[e]})&&this.isFree&&this.freeMultiAni(this.featureMultiplier),Promise.all(i.map(function(e){return t.symbols[e].showWinAni()}))},n.prototype.showScatterLine=function(){var e=this;return Promise.all(this.spinResp.payload.getFeatureChance?this.spinResp.payload.scatterGrid.map(function(t,i){var n=t+3*i;return e.symbols[n].showWinAni(!1)}):[])},n.prototype.showFreeChange=function(){var t=this;return new Promise(function(i,n){t.spinResp.payload.getFeatureChance?(e.SoundPlayer.playEffect("CaiShen_243_Get_FreeGame_ogg"),t.freeChanceGroup.visible=!0,t.freeChangeMc.play(),t.setFreeChooseCount(!0),egret.Tween.get(t.freeChangeImg).set({scaleX:3,scaleY:3}).to({scaleX:1,scaleY:1},200).wait(3e3).call(function(){egret.Tween.removeTweens(t.freeChangeImg),t.freeChanceGroup.visible=!1,i()})):i()})},n.prototype.showBonusLine=function(){var t=this,i=this.spinResp.payload.featureData.featureBonusData.grid,n=this.spinResp.payload.featureData.featureBonusData.gold;return n>0&&e.SoundPlayer.playEffect("CaiShen_243_Bonus_mp3"),Promise.all(n>0?i.map(function(i,o){return new Promise(function(r,s){if(-1==i)r();else{t.lineWinTxt.visible=!0,t.lineWinTxt.text=n.toFixed(2);var a=i+3*o,u=t["tile"+a];t.particleBg.visible=!0;var h=new e.AMovieClip;h.sources="T_hongbao_|1-16|_png",h.x=u.x,h.y=u.y,t.winGridGroup.addChild(h),u.visible=!1,h.loop=2,h.play();var l=[],c=0,p=function(){var i=new e.AMovieClip;i.sources="SU_Coin_Gold_3x3_|1-9|_png",i.x=u.x+u.width/2,i.y=u.y+70,i.width=i.height=30,i.anchorOffsetX=i.anchorOffsetY=15,i.speedx=Math.round(10*Math.random()-5),i.speedy=-Math.round(7*Math.random()+7),i.count=0,t.bonusEffectGroup.addChild(i),l.push(i),i.play()};egret.Tween.get(t.bonusEffectGroup,{loop:!0}).wait(30).call(function(){++c%3==0&&p(),l.forEach(function(e,t){e.x+=e.speedx,e.y+=e.speedy,e.speedy++,++e.count>24&&(e.stop(),e.parent.removeChild(e),l.splice(t,1))})});var f=RES.getRes("star_png"),g=RES.getRes("bonusParticle_json"),m=new particle.GravityParticleSystem(f,g);m.blendMode=egret.BlendMode.ADD,m.emitterX=u.x+u.width/2,m.emitterY=u.y+70,t.bonusEffectGroup.addChild(m),m.start(),h.once(e.AMovieClip.COMPLETE,function(){for(h.parent.removeChild(h),t["tile"+a].visible=!0,t.particleBg.visible=!1,t.lineWinTxt.visible=!1,egret.Tween.removeTweens(t.bonusEffectGroup);l.length>0;)l.pop().stop();t.bonusEffectGroup.removeChildren(),m&&(m.stop(),m.parent&&m.parent.removeChild(m)),r()},t)}})}):[])},n.prototype.showEveryLineGrid=function(t){var i=this;return this.setState(e.GameState.SHOW_SINGLE_LINES),new Promise(function(e,n){return __awaiter(i,void 0,void 0,function(){var i,n,o=this;return __generator(this,function(r){switch(r.label){case 0:i=function(e,t){return __awaiter(o,void 0,void 0,function(){var i=this;return __generator(this,function(n){switch(n.label){case 0:return this.lineWinTxt.visible=!0,this.lineWinTxt.text=e.gold.toFixed(2),[4,Promise.all(e.winCard.map(function(e,t){return i.symbols[e+3*t].showWinAni(!1)}))];case 1:return n.sent(),console.log("第"+t+"条中奖线展示完成",e),[2]}})})},n=0,r.label=1;case 1:return n<t.length?[4,i(t[n],n)]:[3,4];case 2:r.sent(),r.label=3;case 3:return n++,[3,1];case 4:return this.particleBg.visible=!1,e(),[2]}})})})},n.prototype.cancelLinesWin=function(){this.setState(e.GameState.BET),this.lineWinTxt.visible=!1,this.particleBg.visible=!1,this.lineWinTxt.text="",this.symbols.forEach(function(e){e.reset()}),this.isFree?0==this.freeSpinRemainCount?this.showFreeTotalWin(this.spinResp.payload.featureData.featureRoundGold):(this.setState(e.GameState.BET),this.spin(),this.bottomBar.setAutoBetNum(this.freeSpinRemainCount)):(this.setState(e.GameState.BET),(this.autoMax||this.autoCount>0)&&this.spin())},n.prototype.showFreeChoose=function(e){this.freeTotalWin.visible=!1,this.freeChoose.visible=e,e&&this.freeChoose.show(),this.updateBgm()},n.prototype.showFreeGame=function(t){var i=this;this.freeTotalWin.visible=!1,this.bg.visible=!t,this.bgFree.visible=t,this.kuang.visible=!t,this.kuangFree.visible=t,this.freeCountBg.visible=t,this.setFreeChooseCount(),this.setState(e.GameState.BET),this.updateBgm(),setTimeout(function(){t?i.spin():(i.autoMax||i.autoCount>0)&&i.spin()},500)},n.prototype.setFreeChooseCount=function(e){var t=this;void 0===e&&(e=!1),this.freeChooseCountBoom.sources="zz_|1-61|_png",egret.Tween.removeTweens(this.freeChooseCountBoom),this.freeChooseCountBoom.scaleX=1,this.freeChooseCountBoom.scaleY=1,this.freeChooseCountBoom.x=960,this.freeChooseCountBoom.y=540;var i=this.featureChanceCount>0;e?i&&egret.Tween.get(this.freeChooseCountBoom).call(function(){return t.freeChooseCountBoom.visible=!0}).to({scaleX:.3,scaleY:.3,x:1727,y:187},1e3).to({scaleX:1.2,scaleY:1.2},10).call(function(){t.freeChooseCountBoom.play(),t.freeChooseCountTxt.text="x"+t.featureChanceCount,t.freeChooseCountBg.visible=i,t.freeChooseCountTxt.visible=i,setTimeout(function(){t.freeChooseCountBoom.stop(),t.freeChooseCountBoom.visible=!1},1e3)}):(this.freeChooseCountBg.visible=i,this.freeChooseCountTxt.visible=i,i&&(this.freeChooseCountTxt.text="x"+this.featureChanceCount))},n.prototype.freeMultiAni=function(e,t){var i=this;if(void 0===t&&(t=!0),t){this.freeMultiGroup.visible=!0,this.freeMulti.text="X"+e;var n=function(e,t,n,o){var r=new particle.GravityParticleSystem(e,t);return i.freeMultiGroup.addChildAt(r,n),r.emitterX=100,r.emitterY=70,o&&(r.blendMode=egret.BlendMode.ADD),r.start(),r};this.thePArr=[],this.thePArr.push(n(RES.getRes("freemultiLight_png"),RES.getRes("particle_multiLight_json"),0,!0)),this.thePArr.push(n(RES.getRes("freemulti_png"),RES.getRes("particle_multi_json"),1))}else this.thePArr.forEach(function(e){e.stop(),e.visible=!1,e.parent&&e.parent.removeChild(e)}),this.thePArr=[],this.freeMultiGroup.visible=!1},n.prototype.showFreeTotalWin=function(e){this.freeTotalWin.showTotalWin(e),this.thePArr&&this.thePArr.length>0&&this.freeMultiAni(this.featureMultiplier,!1)},n.prototype.freeComplete=function(){this.featureChanceCount>0?this.showFreeChoose(!0):(this.isFree=!1,this.showFreeGame(!1),this.bottomBar.setFree(!1),this.setState(e.GameState.BET))},n}(e.BaseUI);e.GameScene=t,__reflect(t.prototype,"game.GameScene",["game.INotify"]);var i=function(){function t(e,t){this.tile=e,this.gameScene=t;var i=RES.getRes("light_lizi01_png"),n=RES.getRes("particle_json");this.p=new particle.GravityParticleSystem(i,n),this.p.blendMode=egret.BlendMode.ADD,t.particleGroup.addChild(this.p),this.p.visible=!1}return t.prototype.setTexture=function(e){this.tile.source=e},t.prototype.showWinAni=function(t){var i=this;return void 0===t&&(t=!0),new Promise(function(n,o){i.gameScene.winGridGroup.addChild(i.tile),"0"==i.value?(i.mc=new e.AMovieClip,i.mc.sources="T_tongqian_|1-16|_png",i.mc.speed=2,i.mc.x=i.tile.x,i.mc.y=i.tile.y,i.mc.width=i.tile.width,i.mc.height=i.tile.height,i.gameScene.winGridGroup.addChild(i.mc),i.mc.play(),i.mc.loop=t?4:2,i.tile.visible=!1,i.mc.once(e.AMovieClip.COMPLETE,function(){i.mc.visible=!1,i.tile.visible=!0},i)):"1"==i.value&&(i.tile.source="-1"!=i.gameScene.buff?"wildbg"+i.gameScene.buff+"_png":"wildBg0_png",i.mc=new e.AMovieClip,i.mc.sources="caishenAni|1-16|_png",i.mc.x=i.tile.x+10,i.mc.y=i.tile.y,i.mc.width=173,i.mc.height=173,i.mc.speed=4,i.mc.loop=t?2:1,i.gameScene.winGridGroup.addChild(i.mc),i.mc.play(),i.mc2=new e.AMovieClip,i.mc2.sources="wildText|1-20|_png",i.mc2.x=i.tile.x,i.mc2.y=i.tile.y+99,i.mc2.speed=4,i.mc2.loop=t?2:1,i.gameScene.winGridGroup.addChild(i.mc2),i.mc2.play()),i.gameScene.particleBg.visible=!0;var r=i.p,s=i.tile;r.visible=!0,r.start(),r.emitterX=r.emitterY=0,r.x=s.x,r.y=s.y;var a=function(){egret.Tween.get(r).to({emitterX:s.width},450).to({emitterY:s.height},450).to({emitterX:0},450).to({emitterY:0},450).call(function(){r.stop(),r.visible=!1,i.gameScene.particleBg.visible=!1,i.mc&&(i.mc.stop(),i.mc.parent.removeChild(i.mc),i.mc=null,i.tile.visible=!0),i.mc2&&(i.mc2.stop(),i.mc2.parent.removeChild(i.mc2),i.mc2=null),"1"==i.value&&(i.tile.source="-1"!=i.gameScene.buff?"symbolName_1_"+i.gameScene.buff+"_png":"symbolName_1_png"),i.gameScene.valueTiles.addChild(i.tile),i.gameScene.lineWinTxt.visible=!1}).wait(1e3).call(function(){egret.Tween.removeTweens(r),n()})};t?egret.Tween.get(r).to({emitterX:s.width},450).to({emitterY:s.height},450).to({emitterX:0},450).to({emitterY:0},450).call(a):a()})},t.prototype.reset=function(){this.p&&(this.p.stop(),this.p.visible=!1,egret.Tween.removeTweens(this.p)),this.mc&&(this.mc.stop(),this.mc.parent.removeChild(this.mc),this.mc=null),this.mc2&&(this.mc2.stop(),this.mc2.parent.removeChild(this.mc2),this.mc2=null),"1"==this.value&&(this.gameScene.isFree?this.tile.source="symbolName_1_"+this.gameScene.buff+"_png":this.tile.source="symbolName_1_png"),this.tile.visible=!0,this.tile.parent!=this.gameScene.valueTiles&&this.gameScene.valueTiles.addChild(this.tile)},t}();__reflect(i.prototype,"Symbol")}(game||(game={}));var game;!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.skinName=e.GlobalConfig.skinPath+"rullSkin.exml",i}return __extends(i,t),i.prototype.init=function(){this.defaultData(),this.eventListen(),this.defaultUI()},i.prototype.rullShow=function(t,i){void 0===i&&(i=!1),this.visible=i,i&&(this.btnState(0,!1),this.setOdds(t),e.SoundPlayer.playEffect("CaiShen_243_GUI_Generic1_mp3"))},i.prototype.defaultData=function(){this.pageArr=[0,1,2,3,4,5],this.startX=0,this.dragDistance=300,this.oddsArr=[[800,100,50],[800,100,35],[800,100,30],[300,50,20],[300,35,15],[200,30,10],[200,20,10],[100,15,10],[100,15,5],[100,10,5],[50,10,5]]},i.prototype.defaultUI=function(){this.rullShow(.01),this.groupRull.mask=this.rullMask},i.prototype.setOdds=function(e){var t=this,i=100*e;this.oddsArr.forEach(function(e,n){e.forEach(function(e,o){t["pageTxt_"+n+"_"+o].textFlow=[{text:5-o+" ",style:{textColor:16565300}},{text:(e*i/100).toFixed(2),style:{textColor:15854269}}]})})},i.prototype.eventListen=function(){var t=this;this.pageArr.forEach(function(e){t.registerEvent(t["btnRull"+e],egret.TouchEvent.TOUCH_TAP,t.toThePage,t)}),this.registerEvent(this.groupMove,egret.TouchEvent.TOUCH_BEGIN,this.onMove,this),this.registerEvent(this.groupMove,egret.TouchEvent.TOUCH_MOVE,this.onMove,this),this.registerEvent(this.groupMove,egret.TouchEvent.TOUCH_END,this.onMove,this),this.registerEvent(this.groupMove,egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onMove,this),this.registerEvent(this.btnClose,egret.TouchEvent.TOUCH_TAP,function(){t.rullShow(.01),e.SoundPlayer.playEffect("CaiShen_243_GUI_Generic2_mp3")},this)},i.prototype.toThePage=function(e){var t=e.target.name.split("_")[1];this.btnState(+t)},i.prototype.btnState=function(e,t,i,n){var o=this;void 0===t&&(t=!0),void 0===i&&(i=500),this.pageArr.forEach(function(e){o["btnRull"+e].currentState="up"}),this["btnRull"+e].currentState="down";var r=-(1726*e)+97;t?this.moveAni(r,i).then(function(){n&&n.call(o)}):this.groupRull.left=r},i.prototype.moveAni=function(e,t){var i=this;return void 0===t&&(t=500),new Promise(function(n,o){egret.Tween.removeTweens(i.groupRull),egret.Tween.get(i.groupRull).to({left:e},t).call(function(){egret.Tween.removeTweens(i.groupRull),n()})})},i.prototype.onMove=function(e){var t=this;switch(e.type){case egret.TouchEvent.TOUCH_BEGIN:this.startX=e.localX,this.rullX=this.groupRull.left;break;case egret.TouchEvent.TOUCH_MOVE:this.groupRull.left=this.rullX+(e.localX-this.startX);break;case egret.TouchEvent.TOUCH_END:if(this.groupRull.left>97||this.groupRull.left<-8533)this.moveAni(this.rullX,300).then(function(){return t.rullX=t.groupRull.left});else{var i=this.groupRull.left-this.rullX,n=i>=0?1726:-1726,o=Math.abs(i)<this.dragDistance?this.rullX:this.rullX+n;this.btnState(Math.abs((o-97)/1726),!0,300,function(){return t.rullX=t.groupRull.left})}break;case egret.TouchEvent.TOUCH_RELEASE_OUTSIDE:this.moveAni(this.rullX,300)}},i.prototype.dispose=function(){t.prototype.dispose.call(this)},i}(e.BaseUI);e.Rull=t,__reflect(t.prototype,"game.Rull")}(game||(game={}));var game;!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.skinName=e.GlobalConfig.skinPath+"settingSkin.exml",i}return __extends(i,t),i.prototype.init=function(){this.visible=!1,this.bgSetting.visible=!1,this.eventListen(),this.btnFast.currentState="down"},i.prototype.eventListen=function(){this.registerEvent(this.btnClose,egret.TouchEvent.TOUCH_TAP,this.settingClose,this),this.registerEvent(this.btnMusic,egret.TouchEvent.TOUCH_TAP,this.theMusic,this),this.registerEvent(this.btnEffect,egret.TouchEvent.TOUCH_TAP,this.theEffect,this),this.registerEvent(this.btnFast,egret.TouchEvent.TOUCH_TAP,this.theFast,this)},i.prototype.settingShow=function(){var t=this;this.visible=!0,this.bgSetting.visible=!0,this.defaultUI(!0),egret.Tween.get(this.groupSetting).to({scaleX:1.1,scaleY:1.1,alpha:1},250).to({scaleX:1,scaleY:1,alpha:1},50).call(function(){egret.Tween.removeTweens(t.groupSetting),e.SoundPlayer.playEffect("CaiShen_243_GUI_Generic1_mp3")})},i.prototype.settingClose=function(){var t=this;this.bgSetting.visible=!1,egret.Tween.get(this.groupSetting).to({scaleX:1.1,scaleY:1.1,alpha:1},50).to({scaleX:.3,scaleY:.3,alpha:0},250).call(function(){t.defaultUI(!1),t.visible=!1,egret.Tween.removeTweens(t.groupSetting),e.SoundPlayer.playEffect("CaiShen_243_GUI_Generic2_mp3")})},i.prototype.defaultUI=function(e){this.groupSetting.scaleX=e?.3:1,this.groupSetting.scaleY=e?.3:1,this.groupSetting.alpha=e?0:1},i.prototype.defaultOpen=function(){e.SoundPlayer.closeMusic(!1),e.SoundPlayer.closeEffect(!1),this.sendNotify(e.NotifyConst.updateBgm)},i.prototype.theMusic=function(t){var i="up"==t.target.currentState;e.SoundPlayer.closeMusic(!i),this.sendNotify(e.NotifyConst.updateBgm)},i.prototype.theEffect=function(t){var i="up"==t.target.currentState;e.SoundPlayer.closeEffect(!i)},i.prototype.theFast=function(t){this.btnFast.currentState="up"==t.target.currentState?"down":"up",e.GlobalConfig.fastSwitch="up"==this.btnFast.currentState},i.prototype.dispose=function(){t.prototype.dispose.call(this)},i}(e.BaseUI);e.Setting=t,__reflect(t.prototype,"game.Setting")}(game||(game={}));var game;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(eui.Component);e.Tips=t,__reflect(t.prototype,"game.Tips")}(game||(game={}));var game;!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.skinName=e.GlobalConfig.skinPath+"topBarSkin.exml",i}return __extends(i,t),i.prototype.init=function(){this.eventListen()},i.prototype.eventListen=function(){var t=this;this.registerEvent(this.setBtn,egret.TouchEvent.TOUCH_TAP,function(){t.sendNotify(e.NotifyConst.openSetting)},this)},i.prototype.setUser=function(e){this.userName.text=e},i.prototype.setBalance=function(e,t){t?(this.winNum=+e-t,this.payOut(+e)):this.userMoney.text=e},i.prototype.payOut=function(e){var t=this;egret.Tween.get(this,{onChange:function(){t.userMoney.text=t.winNum.toFixed(2)},onChangeObj:this}).to({winNum:e},800).call(function(){return egret.Tween.removeTweens(t)}),egret.Tween.get(this.userMoney).to({scaleX:1.2,scaleY:1.2},400).to({scaleX:1,scaleY:1},400).call(function(){return egret.Tween.removeTweens(t.userMoney)})},i.prototype.dispose=function(){t.prototype.dispose.call(this)},i}(e.BaseUI);e.TopBar=t,__reflect(t.prototype,"game.TopBar")}(game||(game={}));